<!DOCTYPE html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: June 20, 2024 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Hugo Blox Builder 5.9.7" />
  

  
  












  
  










  







  
  

  
  
  

  
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.26c458e6907dc03073573976b7f4044e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.88eac37c0928c6d9f75a4489e6f10b4a.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  



























  
  
  






  <meta name="author" content="Hans Rutger Bosker" />





  

<meta name="description" content="This script streamlines an annotation workflow: it presents a TextGrid for manual annotation to the user, you perform some changes, and when you click Next, it automatically saves the changes and presents the next TextGrid, and so on." />



<link rel="alternate" hreflang="en-us" href="https://hrbosker.github.io/resources/scripts/annotate/" />
<link rel="canonical" href="https://hrbosker.github.io/resources/scripts/annotate/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_huae2b00520e03f5ba379b883d5ffe682c_34272_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_huae2b00520e03f5ba379b883d5ffe682c_34272_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />
<meta property="twitter:image" content="https://hrbosker.github.io/media/logo_hu4ee931c5040e3d0fbcac8149a377b250_283935_300x300_fit_lanczos_3.png" />



  

<meta property="og:type" content="article" />
<meta property="og:site_name" content="SPEAC | Hans Rutger Bosker" />
<meta property="og:url" content="https://hrbosker.github.io/resources/scripts/annotate/" />
<meta property="og:title" content="Annotate | SPEAC | Hans Rutger Bosker" />
<meta property="og:description" content="This script streamlines an annotation workflow: it presents a TextGrid for manual annotation to the user, you perform some changes, and when you click Next, it automatically saves the changes and presents the next TextGrid, and so on." /><meta property="og:image" content="https://hrbosker.github.io/media/logo_hu4ee931c5040e3d0fbcac8149a377b250_283935_300x300_fit_lanczos_3.png" /><meta property="og:locale" content="en-us" />

  
  







  




  
  
  

  
  

  


  
  <title>Annotate | SPEAC | Hans Rutger Bosker</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="87e2dde545e138e121782d0c7c595fac" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.4fef3e534144e9903491f0cc6527eccd.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  











  


<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/"><img src="/media/logo_hu4ee931c5040e3d0fbcac8149a377b250_283935_0x70_resize_lanczos_3.png" alt="SPEAC | Hans Rutger Bosker"
            
            ></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/"><img src="/media/logo_hu4ee931c5040e3d0fbcac8149a377b250_283935_0x70_resize_lanczos_3.png" alt="SPEAC | Hans Rutger Bosker"
          
          ></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/research"><span>Research</span></a>
          </li>

          
          

          

          
          
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/news"><span>News</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/people"><span>People</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/publication"><span>Publications</span></a>
          </li>

          
          

          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Resources</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/resources/corpora/"><span>Corpora</span></a>
              
                <a class="dropdown-item" href="/resources/tools/"><span>Research tools</span></a>
              
                <a class="dropdown-item" href="/resources/scripts/"><span>Scripts</span></a>
              
                <a class="dropdown-item" href="/resources/how-to/"><span>How to's</span></a>
              
                <a class="dropdown-item" href="/resources/course-materials/"><span>Course materials</span></a>
              
                <a class="dropdown-item" href="/resources/other-resources/"><span>Other resources</span></a>
              
            </div>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/demos"><span>Demos</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/contact"><span>Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
        
          Scripts
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      <ul class="nav docs-sidenav">
        <li><a href="/resources/"><i class="fas fa-arrow-left pr-1"></i>Resources</a></li>
      </ul>

      
      
        
          
        
      


  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/resources/scripts/">Scripts</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/resources/scripts/save-all/">Save all</a></li>



  <li class="active"><a href="/resources/scripts/annotate/">Annotate</a></li>



  <li class=""><a href="/resources/scripts/batch-processing/">Batch processing</a></li>



  <li class=""><a href="/resources/scripts/move-to-zero-crossings/">Move to zero-crossings</a></li>



  <li class=""><a href="/resources/scripts/manipulate-itd-iid/">Manipulate ITD/IID</a></li>



  <li class=""><a href="/resources/scripts/interpolate-f0/">Interpolate F0 continuum</a></li>



  <li class=""><a href="/resources/scripts/manipulate-formants/">Manipulate formants</a></li>



  <li class=""><a href="/resources/scripts/transplant-intensity-contour/">Transplant intensity contour</a></li>



  <li class=""><a href="/resources/scripts/dynamic-time-warping/">Dynamic Time Warping</a></li>

      
        </ul>
      
    

    
      </div>
    

    
  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      












      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents"></nav>

      











    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <div class="docs-article-container">
        
      </div>

      
      
      

      <div class="docs-article-container">
        
        <h1>Annotate</h1>

        <article class="article-style">

          
          

          <p>This script streamlines an annotation workflow: it presents a TextGrid for manual annotation to the user, you perform some changes, and when you click Next, it automatically saves the changes and presents the next TextGrid, and so on. This is particularly useful for when you have forced aligned TextGrids (e.g., from <a href="https://hrbosker.github.io/resources/other-resources/#videoaudio-editing">WebMAUS</a> or <a href="https://hrbosker.github.io/resources/other-resources/#videoaudio-editing">EasyAlign</a>) that you&rsquo;d like to manually evaluate and edit.</p>
<p>Moreover, the script keeps track of who annotated what, can continue where you left off yesterday, allows users to enter comments about their annotations, and blinds file names to avoid human annotation biases. The script can be updated to present new empty TextGrids (instead of any pre-existing ones, in case you only have .wav files) or to automatically perform changes to TextGrid tiers/intervals before presenting them for manual annotation.</p>
<blockquote>
<p>You can also <a href="../annotate.praat">download the script</a> as a .praat file.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">### Hans Rutger Bosker, Radboud University</span>
</span></span><span class="line"><span class="cl"><span class="c1">### HansRutger.Bosker@ru.nl</span>
</span></span><span class="line"><span class="cl"><span class="c1">### Date: 30 June 2022, run in Praat 6.2.12 on Windows 10</span>
</span></span><span class="line"><span class="cl"><span class="c1">### License: CC BY-NC 4.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt; This script reads a directory containing sound files with pre-existing TextGrids,</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	for instance resulting from a forced aligner (e.g., WebMAUS or EasyAlign).</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	IMPORTANT: Every Sound should have a pre-existing TextGrid file **with the same name**!</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	It opens every Sound + Textgrid combination, presents it to the user for editing,</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	allows the user to enter comments about the annotations, and then saves the</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	edited TextGrid with &#34;_edited&#34; suffix in the subfolder &#39;edited_textgrids&#39;.</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	User comments are tracked in the file &#39;annotation_log.txt&#39; in the same subfolder.</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	&gt;&gt;&gt;&gt;&gt; If you **do not** yet have pre-existing TextGrids (i.e., only sound files),	&lt;&lt;&lt;&lt;&lt;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	&gt;&gt;&gt;&gt;&gt; you can adjust the script to read all .wav files, create new empty TextGrids,	&lt;&lt;&lt;&lt;&lt;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	&gt;&gt;&gt;&gt;&gt; and present those for editing and saving...									&lt;&lt;&lt;&lt;&lt;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	&gt;&gt;&gt;&gt;&gt; See the line with &#34;CREATE EMPTY TEXTGRIDS&#34;									&lt;&lt;&lt;&lt;&lt;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt; This script can be run by multiple users simultaneously, for instance when</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   multiple annotators are working on the same shared folder. It keeps track</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   of what files have already been edited: it only presents TextGrids for editing</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   that do not yet have an &#34;_edited&#34; version pre-existing in the subfolder.</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   This also means that users can close the script or Praat at anytime</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   without losing data. Then, next time someone runs the script, it will</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   start with the files that are &#39;left over&#39; from the previous run.</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	NOTE: This checking of which files already exist can slow the script down</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;	when working with folders with &gt;5000 files...</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt; At present, the script **only** presents pre-existing tiers and intervals</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   for editing (e.g., adding boundaries, dragging boundaries around, etc.).</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   This script can be augmented by automatically adding tiers or intervals</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   before the TextGrid is presented for editing, so users can annotate</span>
</span></span><span class="line"><span class="cl">	<span class="c1">###&gt;&gt;   new tiers/intervals. See the line with &#34;ADD/REMOVE TIERS HERE&#34;.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">### Variables you will definitely need to customize:</span>
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Where can the Sound and TextGrid files be found?</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">dir_in</span><span class="o">$</span> <span class="o">=</span> <span class="s2">&#34;C:\Users\hanbos\mysounds&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Do you want to use &#39;blinded&#39; objects in Praat to avoid human biases in annotation?</span>
</span></span><span class="line"><span class="cl"><span class="c1">### Default value: &#34;yes&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">### Change to &#34;no&#34; if you want to use original object names.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">blinded</span><span class="o">$</span> <span class="o">=</span> <span class="s2">&#34;yes&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">### Before we start, let&#39;s check whether you&#39;ve entered sensible</span>
</span></span><span class="line"><span class="cl"><span class="c1">### input for the variables above...</span>
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Let&#39;s check if the input directory exists.</span>
</span></span><span class="line"><span class="cl"><span class="c1">### This script will throw an error if the directory doesn&#39;t exist</span>
</span></span><span class="line"><span class="cl"><span class="c1">### (i.e., it won&#39;t write to a mysterious temp directory).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### First check whether the input directory ends in a backslash (if so, removed)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">right</span><span class="o">$</span><span class="p">(</span><span class="n">dir_in</span><span class="o">$</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;/&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">dir_in</span><span class="o">$</span> <span class="o">=</span> <span class="n">left</span><span class="o">$</span><span class="p">(</span><span class="n">dir_in</span><span class="o">$</span><span class="p">,</span><span class="n">length</span><span class="p">(</span><span class="n">dir_in</span><span class="o">$</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elsif</span> <span class="n">right</span><span class="o">$</span><span class="p">(</span><span class="n">dir_in</span><span class="o">$</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">dir_in</span><span class="o">$</span> <span class="o">=</span> <span class="n">left</span><span class="o">$</span><span class="p">(</span><span class="n">dir_in</span><span class="o">$</span><span class="p">,</span><span class="n">length</span><span class="p">(</span><span class="n">dir_in</span><span class="o">$</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">endif</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Then create a temporary txt file in the folder</span>
</span></span><span class="line"><span class="cl"><span class="c1">### and try to write it to the input folder.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### NOTE: The &#34;nocheck&#34; below asks Praat not to complain if the folder</span>
</span></span><span class="line"><span class="cl"><span class="c1">### does *not* exist. We&#39;ll manually check whether the saving of this</span>
</span></span><span class="line"><span class="cl"><span class="c1">### temp txt file has succeeded or not further down below.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">temp_filename</span><span class="o">$</span> <span class="o">=</span> <span class="n">dir_in</span><span class="o">$</span> <span class="o">+</span> <span class="s2">&#34;/&#34;</span> <span class="o">+</span> <span class="s2">&#34;my_temporary_Praat_file.txt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">nocheck</span> <span class="n">writeFileLine</span><span class="p">:</span> <span class="n">temp_filename</span><span class="o">$</span><span class="p">,</span> <span class="s2">&#34;This is just to check if the directory exists&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Can the file be found?</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">file_exists_yesno</span> <span class="o">=</span> <span class="n">fileReadable</span><span class="p">(</span><span class="n">temp_filename</span><span class="o">$</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">file_exists_yesno</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># if you *could* read that temp txt file,</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># this confirms that the directory is valid.</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># Then you can delete it.</span>
</span></span><span class="line"><span class="cl">	<span class="n">deleteFile</span><span class="p">:</span> <span class="n">temp_filename</span><span class="o">$</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># if that file wasn&#39;t readable, that means that the directory wasn&#39;t valid. </span>
</span></span><span class="line"><span class="cl">	<span class="n">printline</span> <span class="n">The</span> <span class="n">folder</span> <span class="s1">&#39;dir_in$&#39;</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">found</span>
</span></span><span class="line"><span class="cl">	<span class="n">exit</span> <span class="n">Your</span> <span class="n">directory</span> <span class="n">doesn</span><span class="s1">&#39;t exist. Check spelling. The directory must *already* exist.</span>
</span></span><span class="line"><span class="cl"><span class="n">endif</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Let&#39;s also check whether a subfolder with edited TextGrids already exists,</span>
</span></span><span class="line"><span class="cl"><span class="c1">## for instance when the script has been run and exited before.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">temp_filename</span><span class="o">$</span> <span class="o">=</span> <span class="n">dir_in</span><span class="o">$</span> <span class="o">+</span> <span class="s2">&#34;/edited_textgrids/&#34;</span> <span class="o">+</span> <span class="s2">&#34;my_temporary_Praat_file.txt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">nocheck</span> <span class="n">writeFileLine</span><span class="p">:</span> <span class="n">temp_filename</span><span class="o">$</span><span class="p">,</span> <span class="s2">&#34;This is just to check if the subfolder exists&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Can the file be found?</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">subfolderfile_exists_yesno</span> <span class="o">=</span> <span class="n">fileReadable</span><span class="p">(</span><span class="n">temp_filename</span><span class="o">$</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">subfolderfile_exists_yesno</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># if you *could* read that temp txt file,</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># this confirms that the subfolder already exists.</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># Then you can delete it.</span>
</span></span><span class="line"><span class="cl">	<span class="n">deleteFile</span><span class="p">:</span> <span class="n">temp_filename</span><span class="o">$</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">	<span class="c1"># if it didn&#39;t yet exist, let&#39;s create the subfolder</span>
</span></span><span class="line"><span class="cl">	<span class="n">createFolder</span><span class="p">:</span> <span class="s2">&#34;&#39;dir_in$&#39;/edited_textgrids&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">endif</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#################################    SCRIPT    #################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Let&#39;s keep track of who annotated which file. This can be helpful when</span>
</span></span><span class="line"><span class="cl"><span class="c1">## multiple annotators run the same script on the same shared folder.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">beginPause</span><span class="p">:</span> <span class="s2">&#34;Please enter your name:&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">text</span><span class="p">:</span> <span class="s2">&#34;annotator&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">clicked</span> <span class="o">=</span> <span class="n">endPause</span><span class="p">:</span> <span class="s2">&#34;Next&#34;</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Now we create a list of TextGrid files in the input directory:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Create</span> <span class="n">Strings</span> <span class="n">as</span> <span class="n">file</span> <span class="n">list</span><span class="p">:</span> <span class="s2">&#34;list_of_files&#34;</span><span class="p">,</span> <span class="s2">&#34;&#39;dir_in$&#39;/*.TextGrid&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">#######################################################################################</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## CREATE EMPTY TEXTGRIDS</span>
</span></span><span class="line"><span class="cl">	<span class="c1">########################</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## If you do not yet have pre-existing TextGrids (but a folder with only sound files instead),</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## you can read the sound files in the directory and create empty TextGrids for the user</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## to edit.</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## Adjust this script as follows:</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## - Change *.TextGrid to *.wav in the line above.</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## - Change *.TextGrid to *.wav in the line below starting with &#34;extposition$&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## - Replace this line: Read from file... &#39;dir_in$&#39;\&#39;name$&#39;.TextGrid</span>
</span></span><span class="line"><span class="cl">	<span class="c1">##		with this line: To TextGrid: &#34;manual&#34;, &#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">#######################################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nfiles</span> <span class="o">=</span> <span class="n">Get</span> <span class="n">number</span> <span class="n">of</span> <span class="n">strings</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">nfiles</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="n">exit</span> <span class="n">The</span> <span class="n">directory</span> <span class="s1">&#39;dir_in$&#39;</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">contain</span> <span class="n">any</span> <span class="n">TextGrid</span> <span class="n">files</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">endif</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## By randomizing this file list, it allows for multiple users to simultanously work</span>
</span></span><span class="line"><span class="cl"><span class="c1">## on the same folder without overwriting previous annotations. It also reduces the risk</span>
</span></span><span class="line"><span class="cl"><span class="c1">## of human biases in annotations (e.g., annotator fatigue affecting one condition more</span>
</span></span><span class="line"><span class="cl"><span class="c1">## than another condition).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Randomize</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Now we&#39;ll loop through the list and present individual files...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="n">from</span> <span class="mi">1</span> <span class="n">to</span> <span class="s1">&#39;nfiles&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="n">select</span> <span class="n">Strings</span> <span class="n">list_of_files</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">fileplusext</span><span class="o">$</span> <span class="o">=</span> <span class="n">Get</span> <span class="n">string</span><span class="o">...</span> <span class="s1">&#39;i&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="n">extposition</span> <span class="o">=</span> <span class="n">index</span><span class="p">(</span><span class="n">fileplusext</span><span class="o">$</span><span class="p">,</span> <span class="s2">&#34;.TextGrid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">name</span><span class="o">$</span> <span class="o">=</span> <span class="n">left</span><span class="o">$</span><span class="p">(</span><span class="n">fileplusext</span><span class="o">$</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;extposition&#39;</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">outname</span><span class="o">$</span> <span class="o">=</span> <span class="s2">&#34;&#39;name$&#39;_edited&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">fulloutname</span><span class="o">$</span> <span class="o">=</span> <span class="s2">&#34;&#39;dir_in$&#39;/edited_textgrids/&#39;outname$&#39;.TextGrid&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">## Let&#39;s check if an &#34;_edited&#34; version already exists.</span>
</span></span><span class="line"><span class="cl">	<span class="c1">## The script only presents those files for editing that do not yet have been edited before.</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="n">editedfile_exists_yesno</span> <span class="o">=</span> <span class="n">fileReadable</span><span class="p">(</span><span class="n">fulloutname</span><span class="o">$</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">editedfile_exists_yesno</span>
</span></span><span class="line"><span class="cl">		<span class="n">do_nothing</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span>
</span></span><span class="line"><span class="cl">		<span class="n">Read</span> <span class="n">from</span> <span class="n">file</span><span class="o">...</span> <span class="s1">&#39;dir_in$&#39;</span>\<span class="s1">&#39;name$&#39;</span><span class="o">.</span><span class="n">wav</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">blinded</span><span class="o">$</span> <span class="o">=</span> <span class="s2">&#34;yes&#34;</span>
</span></span><span class="line"><span class="cl">			<span class="n">Rename</span><span class="o">...</span> <span class="n">current_Sound</span>
</span></span><span class="line"><span class="cl">		<span class="n">endif</span>
</span></span><span class="line"><span class="cl">		<span class="n">sound_name</span><span class="o">$</span> <span class="o">=</span> <span class="n">selected</span><span class="o">$</span><span class="p">(</span><span class="s2">&#34;Sound&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## If a filename contains spaces, Praat replaces these spaces with underscores.</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## Example: &#34;file number 1.wav&#34; in a given folder becomes</span>
</span></span><span class="line"><span class="cl">		<span class="c1">##			&#34;file_number_1.wav&#34; in the Praat object window.</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## Therefore, it is important **not** to use a filename variable (here: &#39;name$&#39;)</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## in &#39;selecting commands&#39; in Praat, like &#39;select&#39; and &#39;plus&#39;!</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## Better still: do not use spaces in filenames!</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="n">Read</span> <span class="n">from</span> <span class="n">file</span><span class="o">...</span> <span class="s1">&#39;dir_in$&#39;</span>\<span class="s1">&#39;name$&#39;</span><span class="o">.</span><span class="n">TextGrid</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">blinded</span><span class="o">$</span> <span class="o">=</span> <span class="s2">&#34;yes&#34;</span>
</span></span><span class="line"><span class="cl">			<span class="n">Rename</span><span class="o">...</span> <span class="n">current_TextGrid</span>
</span></span><span class="line"><span class="cl">		<span class="n">endif</span>
</span></span><span class="line"><span class="cl">		<span class="n">tg_name</span><span class="o">$</span> <span class="o">=</span> <span class="n">selected</span><span class="o">$</span><span class="p">(</span><span class="s2">&#34;TextGrid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">#######################################################################################</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## ADD/REMOVE TIERS HERE</span>
</span></span><span class="line"><span class="cl">		<span class="c1">########################</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## This is where we you could adjust the script to automatically add/remove tiers</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## and/or automatically adjust intervals (setting them to the nearest zero crossings?).</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## Duplicating tiers can be helpful when you want to view original vs. manually edited</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## tiers below/above each other in one and the same edited TextGrid.</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## Example:</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## &gt; Duplicate tier... 1 1 newtier</span>
</span></span><span class="line"><span class="cl">		<span class="c1">## [ARGUMENTS: position_of_tier_to_duplicate position_for_new_tier name_of_new_tier]</span>
</span></span><span class="line"><span class="cl">		<span class="c1">#######################################################################################</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">plus</span> <span class="n">Sound</span> <span class="s1">&#39;sound_name$&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="n">Edit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">beginPause</span><span class="p">:</span> <span class="s2">&#34;Please check and edit this TextGrid.&#34;</span>
</span></span><span class="line"><span class="cl">			<span class="n">comment</span><span class="p">:</span> <span class="s2">&#34;Please check and edit the annotations.&#34;</span>
</span></span><span class="line"><span class="cl">			<span class="n">text</span><span class="p">:</span> <span class="s2">&#34;Comments&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="n">clicked</span> <span class="o">=</span> <span class="n">endPause</span><span class="p">:</span> <span class="s2">&#34;Next&#34;</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="n">editor</span> <span class="n">TextGrid</span> <span class="s1">&#39;tg_name$&#39;</span>
</span></span><span class="line"><span class="cl">			<span class="n">Close</span>
</span></span><span class="line"><span class="cl">		<span class="n">endeditor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">select</span> <span class="n">TextGrid</span> <span class="s1">&#39;tg_name$&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="n">Write</span> <span class="n">to</span> <span class="n">text</span> <span class="n">file</span><span class="o">...</span> <span class="s1">&#39;fulloutname$&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="n">plus</span> <span class="n">Sound</span> <span class="s1">&#39;sound_name$&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="n">Remove</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="n">appendFileLine</span><span class="p">:</span> <span class="s2">&#34;&#39;dir_in$&#39;/edited_textgrids/annotation_log.txt&#34;</span><span class="p">,</span> <span class="n">annotator</span><span class="o">$</span><span class="p">,</span> <span class="n">tab</span><span class="o">$</span><span class="p">,</span> <span class="n">name</span><span class="o">$</span><span class="p">,</span> <span class="n">tab</span><span class="o">$</span><span class="p">,</span> <span class="n">comments</span><span class="o">$</span>
</span></span><span class="line"><span class="cl">	<span class="n">endif</span>
</span></span><span class="line"><span class="cl"><span class="n">endfor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">select</span> <span class="n">Strings</span> <span class="n">list_of_files</span>
</span></span><span class="line"><span class="cl"><span class="n">Remove</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1"># End of script</span>
</span></span><span class="line"><span class="cl"><span class="c1">################################################################################</span>
</span></span></code></pre></div>

        </article>

        





        



        
        
        <div class="article-widget">
          
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/resources/scripts/save-all/" rel="next">Save all</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/resources/scripts/batch-processing/" rel="prev">Batch processing</a>
  </div>
  
</div>

        </div>
        
      </div>

      <div class="body-footer">
        <p>Last updated on Jan 1, 0001</p>

        




        




        


      </div>

      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
  

  

  
  <p class="powered-by copyright-license-text">
    © 2024 Hans Rutger Bosker. This work is licensed under <a href="https://creativecommons.org/licenses/by/4.0" rel="noopener noreferrer" target="_blank">CC BY 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  


<script src="/js/vendor-bundle.min.391d344a129df56f7ad674c2c2ed04e8.js"></script>




  

  
  

  






  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>




<script src="https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js" integrity="sha256-aQmOEF2ZD4NM/xt4hthzREIo/2PFkOX/g01WjxEV7Ys=" crossorigin="anonymous"></script>
<script>
  anchors.add();
</script>





  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  

















<script id="page-data" type="application/json">{"use_headroom":false}</script>











  
  


<script src="/en/js/wowchemy.min.7f5ebaff62ae468cff8bb3dd1337bb9b.js"></script>



  <script src="/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js" type="module"></script>




  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.9c0e895144aef5a693008b5c5d450147.js" type="module"></script>


















</body>
</html>
